sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/model/json/JSONModel"],function(e,t,n){"use strict";return e.extend("expensecreation.controller.Expense",{onInit:function(){let e=new n({project_name:"",project_leader:"",start_date:this._getDefaultStartDate(),category:"",financing_type:"",execution_months:"",expense_amount:"",current_co2_impact:"",expected_co2_impact:"",current_water_consumption:"",expected_water_consumption:"",green_payback:"",green_energy_output:"",description:"",submittedBy:"Gebruiker",submittedOn:(new Date).toISOString(),status:"submitted"});this.getView().setModel(e,"expenseModel")},_getDefaultStartDate:function(){let e=new Date;e.setMonth(e.getMonth()+1);return e.toISOString().split("T")[0]},_validateExpenseData:function(){const e=this.getView().getModel("expenseModel").getData();const t=new Date;const n=new Date(e.start_date);const a=["project_name","project_leader","start_date","category","financing_type","execution_months","expense_amount"];const s=a.filter(t=>!e[t]);if(s.length>0){return{valid:false,message:"Vul alle verplichte velden in."}}if(n<t.setDate(t.getDate()+14)){return{valid:false,message:"De startdatum moet minstens 2 weken in de toekomst liggen."}}if(e.financing_type==="CapEx"&&e.expense_amount<1e4){return{valid:false,message:"Een CapEx-aanvraag moet minstens €10.000 bedragen."}}if(e.financing_type==="OpEx"&&e.expense_amount>5e4){return{valid:false,message:"Een OpEx-aanvraag mag niet meer dan €50.000 bedragen."}}if(e.expense_amount>15e4){return{valid:false,message:"Het totaalbedrag mag niet meer dan €150.000 bedragen."}}if(e.execution_months<1||e.execution_months>96){return{valid:false,message:"Het aantal maanden moet tussen 1 en 96 liggen."}}return{valid:true}},onNextTab:function(){const e=this.getView().byId("_IDGenIconTabBar");const t=e.getSelectedKey();const n=e.getItems();for(let a=0;a<n.length;a++){if(n[a].getKey()===t&&a+1<n.length){e.setSelectedKey(n[a+1].getKey());break}}},onPreviousTab:function(){const e=this.getView().byId("_IDGenIconTabBar");const t=e.getSelectedKey();const n=e.getItems();for(let a=0;a<n.length;a++){if(n[a].getKey()===t&&a-1>=0){e.setSelectedKey(n[a-1].getKey());break}}},onCheck:function(){const e=this._validateExpenseData();if(!e.valid){t.error(e.message);return}t.success("Alle gegevens zijn correct ingevuld.");this.getView().byId("_IDGenIconTabBar").setSelectedKey("overview")},onComplete:function(){const e=this.getOwnerComponent().getModel();const n=this.getView().getModel("expenseModel").getData();t.confirm("Wilt u de expense indienen?",{actions:[t.Action.OK,t.Action.CANCEL],onClose:a=>{if(a===t.Action.OK){e.create("/Expenses",n,{success:function(){t.success("De expense is succesvol ingediend.")},error:function(e){t.error("Er is een fout opgetreden: "+e.message)}})}}})},onNavBack:function(){window.history.back()}})});
//# sourceMappingURL=Expense.controller.js.map